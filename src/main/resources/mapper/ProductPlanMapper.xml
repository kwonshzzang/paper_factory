<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.re.etri.batis.mapper.ProductPlanMapper">
  <resultMap id="BaseResultMap" type="kr.re.etri.batis.domain.ProductPlan">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    <id column="product_plan_id" jdbcType="VARCHAR" property="productPlanId" />
    <result column="product_start_date" jdbcType="TIMESTAMP" property="productStartDate" />
    <result column="product_end_date" jdbcType="TIMESTAMP" property="productEndDate" />
    <result column="product_paper_category" jdbcType="VARCHAR" property="productPaperCategory" />
    <result column="product_cotting_paper_category" jdbcType="VARCHAR" property="productCottingPaperCategory" />
    <result column="coiling" jdbcType="INTEGER" property="coiling" />
    <result column="output" jdbcType="INTEGER" property="output" />
    <result column="output_unit_id" jdbcType="VARCHAR" property="outputUnitId" />
    <result column="digital" jdbcType="VARCHAR" property="digital" />
    <result column="skid" jdbcType="VARCHAR" property="skid" />
    <result column="bigo" jdbcType="VARCHAR" property="bigo" />
    <result column="created_at" jdbcType="TIMESTAMP" property="createdAt" />
    <result column="created_by" jdbcType="VARCHAR" property="createdBy" />
    <result column="updated_at" jdbcType="TIMESTAMP" property="updatedAt" />
    <result column="updated_by" jdbcType="VARCHAR" property="updatedBy" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    delete from product_plan
    where product_plan_id = #{productPlanId,jdbcType=VARCHAR}
  </delete>
  <insert id="insert" parameterType="kr.re.etri.batis.domain.ProductPlan">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    insert into product_plan (product_plan_id, product_start_date, 
      product_end_date, product_paper_category, 
      product_cotting_paper_category, coiling, output, 
      output_unit_id, digital, skid, 
      bigo, created_at, created_by, 
      updated_at, updated_by)
    values (#{productPlanId,jdbcType=VARCHAR}, #{productStartDate,jdbcType=TIMESTAMP}, 
      #{productEndDate,jdbcType=TIMESTAMP}, #{productPaperCategory,jdbcType=VARCHAR}, 
      #{productCottingPaperCategory,jdbcType=VARCHAR}, #{coiling,jdbcType=INTEGER}, #{output,jdbcType=INTEGER}, 
      #{outputUnitId,jdbcType=VARCHAR}, #{digital,jdbcType=VARCHAR}, #{skid,jdbcType=VARCHAR}, 
      #{bigo,jdbcType=VARCHAR}, #{createdAt,jdbcType=TIMESTAMP}, #{createdBy,jdbcType=VARCHAR}, 
      #{updatedAt,jdbcType=TIMESTAMP}, #{updatedBy,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="kr.re.etri.batis.domain.ProductPlan">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    update product_plan
    set product_start_date = #{productStartDate,jdbcType=TIMESTAMP},
      product_end_date = #{productEndDate,jdbcType=TIMESTAMP},
      product_paper_category = #{productPaperCategory,jdbcType=VARCHAR},
      product_cotting_paper_category = #{productCottingPaperCategory,jdbcType=VARCHAR},
      coiling = #{coiling,jdbcType=INTEGER},
      output = #{output,jdbcType=INTEGER},
      output_unit_id = #{outputUnitId,jdbcType=VARCHAR},
      digital = #{digital,jdbcType=VARCHAR},
      skid = #{skid,jdbcType=VARCHAR},
      bigo = #{bigo,jdbcType=VARCHAR},
      created_at = #{createdAt,jdbcType=TIMESTAMP},
      created_by = #{createdBy,jdbcType=VARCHAR},
      updated_at = #{updatedAt,jdbcType=TIMESTAMP},
      updated_by = #{updatedBy,jdbcType=VARCHAR}
    where product_plan_id = #{productPlanId,jdbcType=VARCHAR}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.String" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    select product_plan_id, product_start_date, product_end_date, product_paper_category, 
    product_cotting_paper_category, coiling, output, output_unit_id, digital, skid, bigo, 
    created_at, created_by, updated_at, updated_by
    from product_plan
    where product_plan_id = #{productPlanId,jdbcType=VARCHAR}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    select product_plan_id, product_start_date, product_end_date, product_paper_category, 
    product_cotting_paper_category, coiling, output, output_unit_id, digital, skid, bigo, 
    created_at, created_by, updated_at, updated_by
    from product_plan
  </select>
  
  
  
  <select id="selectNowPlan"  resultType="HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    SELECT A.product_plan_id, A.product_start_date, A.product_end_date, C.product_type_name, B.weight, D.weight,
	       A.coiling, A.output, A.output_unit_id, A.digital, A.skid
	FROM paper_dt.product_plan A,
	     paper_dt.product B,
	     paper_dt.product_type C,
		 paper_dt.product D,
	     paper_dt.product_type E
	WHERE now() between product_start_date and product_end_date
	AND A.product_paper_category = B.product_id
	AND B.product_type_id = C.product_type_id
	AND A.product_cotting_paper_category = D.product_id
	AND D.product_type_id = E.product_type_id
	ORDER BY product_start_date DESC
	LIMIT 1

  </select>
  
  
  <select id="selectTodayPlan"  resultType="HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    SELECT A.product_plan_id, A.product_start_date, A.product_end_date, C.product_type_name, B.weight, D.weight,
       	A.coiling, A.output, A.output_unit_id, A.digital, A.skid
	FROM paper_dt.product_plan A,
	     paper_dt.product B,
	     paper_dt.product_type C,
		 paper_dt.product D,
	     paper_dt.product_type E
	WHERE (date(product_start_date) = date(now()) or date(product_end_date) = date(now()))
	AND A.product_paper_category = B.product_id
	AND B.product_type_id = C.product_type_id
	AND A.product_cotting_paper_category = D.product_id
	AND D.product_type_id = E.product_type_id
	ORDER BY product_start_date
  </select>
  
  
  <select id="selectMonthPlanList"  resultType="HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    SELECT A.product_plan_id, A.product_start_date, A.product_end_date, C.product_type_name, B.weight, E.product_type_name as cotting_product_type_name, D.weight as cotting_weight,
	       A.coiling, A.output, A.output_unit_id, A.digital, A.skid, A.bigo
	FROM paper_dt.product_plan A,
	     paper_dt.product B,
	     paper_dt.product_type C,
		 paper_dt.product D,
	     paper_dt.product_type E
	WHERE DATE_FORMAT(product_start_date, '%Y%m') =  DATE_FORMAT(now(), '%Y%m')
	AND A.product_paper_category = B.product_id
	AND B.product_type_id = C.product_type_id
	AND A.product_cotting_paper_category = D.product_id
	AND D.product_type_id = E.product_type_id
	ORDER BY product_start_date
  </select>
  
  
  <select id="selectTodayNowTotalPerProductType" parameterType="java.lang.String"  resultType="HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    
  	<![CDATA[
    SELECT C.product_type_name as product_type_name, sum(A.output) as total
	FROM paper_dt.product_plan A,
	     paper_dt.product B,
	     paper_dt.product_type C,
		 paper_dt.product D,
	     paper_dt.product_type E
	WHERE DATE_FORMAT(product_start_date, #{searchDateType,jdbcType=VARCHAR}) =  DATE_FORMAT(now(), #{searchDateType,jdbcType=VARCHAR})
    AND product_end_date <= now()
	AND A.product_paper_category = B.product_id
	AND B.product_type_id = C.product_type_id
	AND A.product_cotting_paper_category = D.product_id
	AND D.product_type_id = E.product_type_id
	group by product_type_name;
	]]>
  </select>
  
  <select id="selectMonthTotalPerProductType" parameterType="java.lang.String"  resultType="HashMap">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 20 10:51:28 KST 2022.
    -->
    SELECT C.product_type_name as product_type_name, sum(A.output) as total
	FROM paper_dt.product_plan A,
	     paper_dt.product B,
	     paper_dt.product_type C,
		 paper_dt.product D,
	     paper_dt.product_type E
	WHERE DATE_FORMAT(product_start_date, #{searchDateType,jdbcType=VARCHAR}) =  DATE_FORMAT(now(), #{searchDateType,jdbcType=VARCHAR})
	AND A.product_paper_category = B.product_id
	AND B.product_type_id = C.product_type_id
	AND A.product_cotting_paper_category = D.product_id
	AND D.product_type_id = E.product_type_id
	group by product_type_name;
  </select>
</mapper>